data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5JbnRlcmFjdGl2ZSBJbWFnZSBPdmVybGF5IHdpdGggU2VwYXJhdGUgQ29udHJvbHM8L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgIC5maWxlLWlucHV0LWNvbnRhaW5lciB7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICBwYWRkaW5nOiAyMHB4OwogICAgICAgICAgICBib3JkZXI6IDRweCBzb2xpZCAjMDAwOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjODRjOGQ1OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlOwogICAgICAgIH0KCiAgICAgICAgLmZpbGUtaW5wdXQgewogICAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIH0KCiAgICAgICAgLmZpbGUtaW5wdXQtY29udGFpbmVyOmhvdmVyIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2UzZmY4ODsKICAgICAgICB9CgogICAgICAgICNvdmVybGF5R2FsbGVyeSBpbWcgewogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIHdpZHRoOiAxMDBweDsKICAgICAgICAgICAgaGVpZ2h0OiAxMDBweDsKICAgICAgICAgICAgb2JqZWN0LWZpdDogY292ZXI7CiAgICAgICAgICAgIG1hcmdpbjogNXB4OwogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB0cmFuc3BhcmVudDsKICAgICAgICB9CgogICAgICAgICNvdmVybGF5R2FsbGVyeSBpbWcuc2VsZWN0ZWQgewogICAgICAgICAgICBib3JkZXItY29sb3I6ICMwMDA7CiAgICAgICAgfQoKICAgICAgICAjY2FudmFzIHsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgICAgfQoKICAgICAgICAuY29udHJvbHMgewogICAgICAgICAgICBtYXJnaW4tdG9wOiAxMHB4OwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICB9CgogICAgICAgIC5jb250cm9scyBidXR0b24gewogICAgICAgICAgICBtYXJnaW46IDVweDsKICAgICAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGRpdiBjbGFzcz0iZmlsZS1pbnB1dC1jb250YWluZXIiPgogICAgICAgIDxsYWJlbCBmb3I9ImltYWdlSW5wdXQiPlVwbG9hZCBJbWFnZSB0byBPdmVybGF5PC9sYWJlbD4KICAgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgaWQ9ImltYWdlSW5wdXQiIGFjY2VwdD0iaW1hZ2UvKiIgY2xhc3M9ImZpbGUtaW5wdXQiPgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iZmlsZS1pbnB1dC1jb250YWluZXIiPgogICAgICAgIDxsYWJlbCBmb3I9Im92ZXJsYXlJbnB1dCI+VXBsb2FkIEN1c3RvbSBPdmVybGF5IEltYWdlPC9sYWJlbD4KICAgICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgaWQ9Im92ZXJsYXlJbnB1dCIgYWNjZXB0PSJpbWFnZS8qIiBjbGFzcz0iZmlsZS1pbnB1dCI+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJvdmVybGF5R2FsbGVyeSI+PC9kaXY+CgogICAgPGNhbnZhcyBpZD0iY2FudmFzIj48L2NhbnZhcz4KCiAgICA8ZGl2IGNsYXNzPSJjb250cm9scyI+CiAgICAgICAgPGJ1dHRvbiBpZD0icm90YXRlTGVmdCI+Um90YXRlIExlZnQ8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGlkPSJyb3RhdGVSaWdodCI+Um90YXRlIFJpZ2h0PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0iZmxpcEhvcml6b250YWwiPkZsaXAgSG9yaXpvbnRhbDwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9ImZsaXBWZXJ0aWNhbCI+RmxpcCBWZXJ0aWNhbDwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9InNhdmVJbWFnZSI+U2F2ZSBJbWFnZTwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICBjb25zdCBpbWFnZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltYWdlSW5wdXQnKTsKICAgICAgICBjb25zdCBvdmVybGF5SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheUlucHV0Jyk7CiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpOwogICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIGNvbnN0IG92ZXJsYXlHYWxsZXJ5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXlHYWxsZXJ5Jyk7CgogICAgICAgIGNvbnN0IHJvdGF0ZUxlZnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm90YXRlTGVmdCcpOwogICAgICAgIGNvbnN0IHJvdGF0ZVJpZ2h0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JvdGF0ZVJpZ2h0Jyk7CiAgICAgICAgY29uc3QgZmxpcEhvcml6b250YWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxpcEhvcml6b250YWwnKTsKICAgICAgICBjb25zdCBmbGlwVmVydGljYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmxpcFZlcnRpY2FsJyk7CiAgICAgICAgY29uc3Qgc2F2ZUltYWdlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVJbWFnZScpOwoKICAgICAgICBsZXQgYmFzZUltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgIGxldCBvdmVybGF5SW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgbGV0IGN1c3RvbU92ZXJsYXlJbWcgPSBuZXcgSW1hZ2UoKTsKICAgICAgICBsZXQgY3VycmVudE92ZXJsYXlTcmMgPSAnJzsKICAgICAgICBsZXQgY3VzdG9tT3ZlcmxheVNyYyA9ICcnOwoKICAgICAgICBsZXQgcHJlc2V0T3ZlcmxheSA9IHsKICAgICAgICAgICAgeDogNTAsCiAgICAgICAgICAgIHk6IDUwLAogICAgICAgICAgICB3aWR0aDogMTAwLAogICAgICAgICAgICBoZWlnaHQ6IDEwMCwKICAgICAgICAgICAgcm90YXRpb246IDAsCiAgICAgICAgICAgIGZsaXBYOiAxLAogICAgICAgICAgICBmbGlwWTogMSwKICAgICAgICAgICAgc2VsZWN0ZWQ6IHRydWUKICAgICAgICB9OwoKICAgICAgICBsZXQgY3VzdG9tT3ZlcmxheSA9IHsKICAgICAgICAgICAgeDogMTUwLAogICAgICAgICAgICB5OiAxNTAsCiAgICAgICAgICAgIHdpZHRoOiAxMDAsCiAgICAgICAgICAgIGhlaWdodDogMTAwLAogICAgICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICAgICAgZmxpcFg6IDEsCiAgICAgICAgICAgIGZsaXBZOiAxLAogICAgICAgICAgICBzZWxlY3RlZDogZmFsc2UKICAgICAgICB9OwoKICAgICAgICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgIGxldCBpc1Jlc2l6aW5nID0gZmFsc2U7CiAgICAgICAgbGV0IGRyYWdTdGFydFggPSAwLCBkcmFnU3RhcnRZID0gMDsKICAgICAgICBsZXQgY3VycmVudFJlc2l6ZUhhbmRsZSA9IG51bGw7CiAgICAgICAgY29uc3QgcmVzaXplSGFuZGxlU2l6ZSA9IDEwOwogICAgICAgIGxldCBzY2FsZSA9IDE7CgogICAgICAgIGNvbnN0IG92ZXJsYXlJbWFnZVVybHMgPSBbCiAgICAgICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSWxsZWdhbEFydGlmYWN0cy9CbHVtZS9tYWluL2Ryb3AlMjBvdXQucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vZ2hvc3QucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vaG1wZi5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9ob3BlZnVsbC5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9pc3NhJTIwb2sucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4va29uZnV6aW8ucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vbGl6YXJkLnBuZycsCiAgICAgICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSWxsZWdhbEFydGlmYWN0cy9CbHVtZS9tYWluL2xvdmUlMjBtZS5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9uYWFhaC5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9vay5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9vbWclMjByZWFsbHkucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vc2NhcmVkLnBuZycsCiAgICAgICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSWxsZWdhbEFydGlmYWN0cy9CbHVtZS9tYWluL3NjaGVtZS5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9zbWFydC5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9zbyUyMHdoYXQucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vdGhvdWdodGZ1bGwucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4vdG90YWwlMjBmYWxsb3V0LnBuZycsCiAgICAgICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSWxsZWdhbEFydGlmYWN0cy9CbHVtZS9tYWluL3dhci5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi93b3cucG5nJywKICAgICAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9JbGxlZ2FsQXJ0aWZhY3RzL0JsdW1lL21haW4veWVhJTIwd2hhdGV2YS5wbmcnLAogICAgICAgICAgICAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0lsbGVnYWxBcnRpZmFjdHMvQmx1bWUvbWFpbi9mY2slMjB5b3UucG5nJwogICAgICAgIF07CgogICAgICAgIGltYWdlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlSW1hZ2UpOwogICAgICAgIG92ZXJsYXlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVDdXN0b21PdmVybGF5SW1hZ2UpOwogICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVNb3VzZURvd24pOwogICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVNb3VzZU1vdmUpOwogICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2VVcCk7CiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBoYW5kbGVNb3VzZVVwKTsKCiAgICAgICAgcm90YXRlTGVmdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJvdGF0ZU92ZXJsYXkoLTEwKSk7CiAgICAgICAgcm90YXRlUmlnaHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiByb3RhdGVPdmVybGF5KDEwKSk7CiAgICAgICAgZmxpcEhvcml6b250YWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBmbGlwT3ZlcmxheSgnaG9yaXpvbnRhbCcpKTsKICAgICAgICBmbGlwVmVydGljYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBmbGlwT3ZlcmxheSgndmVydGljYWwnKSk7CiAgICAgICAgc2F2ZUltYWdlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZUltYWdlKTsKCiAgICAgICAgZnVuY3Rpb24gZmV0Y2hPdmVybGF5R2FsbGVyeSgpIHsKICAgICAgICAgICAgb3ZlcmxheUltYWdlVXJscy5mb3JFYWNoKHVybCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKICAgICAgICAgICAgICAgIGltZy5zcmMgPSB1cmw7CiAgICAgICAgICAgICAgICBpbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudE92ZXJsYXlTcmMgPSB1cmw7CiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheUltZy5zcmMgPSBjdXJyZW50T3ZlcmxheVNyYzsKICAgICAgICAgICAgICAgICAgICBvdmVybGF5SW1nLm9ubG9hZCA9IGRyYXdJbWFnZXM7CiAgICAgICAgICAgICAgICAgICAgcHJlc2V0T3ZlcmxheS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgY3VzdG9tT3ZlcmxheS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZUdhbGxlcnlTZWxlY3Rpb24oaW1nKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgb3ZlcmxheUdhbGxlcnkuYXBwZW5kQ2hpbGQoaW1nKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBoYW5kbGVJbWFnZShlKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgICAgICAgaWYgKGZpbGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIGJhc2VJbWcuc3JjID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICAgIGJhc2VJbWcub25sb2FkID0gZHJhd0ltYWdlczsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQ3VzdG9tT3ZlcmxheUltYWdlKGUpIHsKICAgICAgICAgICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgICAgICBpZiAoZmlsZSkgewogICAgICAgICAgICAgICAgY3VzdG9tT3ZlcmxheVNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgICAgICAgICAgICBjdXN0b21PdmVybGF5SW1nLnNyYyA9IGN1c3RvbU92ZXJsYXlTcmM7CiAgICAgICAgICAgICAgICBjdXN0b21PdmVybGF5SW1nLm9ubG9hZCA9IGRyYXdJbWFnZXM7CiAgICAgICAgICAgICAgICBjdXN0b21PdmVybGF5LnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHByZXNldE92ZXJsYXkuc2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZHJhd0ltYWdlcygpIHsKICAgICAgICAgICAgaWYgKGJhc2VJbWcuY29tcGxldGUgJiYgYmFzZUltZy5uYXR1cmFsV2lkdGggPiAwKSB7CiAgICAgICAgICAgICAgICBjb25zdCB3aW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICAgICAgICAgICAgY29uc3Qgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgICAgICAgICAgICAgc2NhbGUgPSBNYXRoLm1pbih3aW5kb3dXaWR0aCAvIGJhc2VJbWcubmF0dXJhbFdpZHRoLCB3aW5kb3dIZWlnaHQgLyBiYXNlSW1nLm5hdHVyYWxIZWlnaHQpOwoKICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGJhc2VJbWcubmF0dXJhbFdpZHRoICogc2NhbGU7CiAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gYmFzZUltZy5uYXR1cmFsSGVpZ2h0ICogc2NhbGU7CiAgICAgICAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7CgogICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShiYXNlSW1nLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwoKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50T3ZlcmxheVNyYyAmJiBvdmVybGF5SW1nLmNvbXBsZXRlKSB7CiAgICAgICAgICAgICAgICAgICAgZHJhd092ZXJsYXkob3ZlcmxheUltZywgcHJlc2V0T3ZlcmxheSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGN1c3RvbU92ZXJsYXlTcmMgJiYgY3VzdG9tT3ZlcmxheUltZy5jb21wbGV0ZSkgewogICAgICAgICAgICAgICAgICAgIGRyYXdPdmVybGF5KGN1c3RvbU92ZXJsYXlJbWcsIGN1c3RvbU92ZXJsYXkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChwcmVzZXRPdmVybGF5LnNlbGVjdGVkIHx8IGN1c3RvbU92ZXJsYXkuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICBkcmF3Qm91bmRpbmdCb3gocHJlc2V0T3ZlcmxheSk7CiAgICAgICAgICAgICAgICAgICAgZHJhd0JvdW5kaW5nQm94KGN1c3RvbU92ZXJsYXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkcmF3T3ZlcmxheShvdmVybGF5LCBvdmVybGF5RGF0YSkgewogICAgICAgICAgICBjdHguc2F2ZSgpOwogICAgICAgICAgICBjb25zdCBjZW50ZXJYID0gb3ZlcmxheURhdGEueCAqIHNjYWxlICsgKG92ZXJsYXlEYXRhLndpZHRoICogc2NhbGUpIC8gMjsKICAgICAgICAgICAgY29uc3QgY2VudGVyWSA9IG92ZXJsYXlEYXRhLnkgKiBzY2FsZSArIChvdmVybGF5RGF0YS5oZWlnaHQgKiBzY2FsZSkgLyAyOwoKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShjZW50ZXJYLCBjZW50ZXJZKTsKICAgICAgICAgICAgY3R4LnJvdGF0ZShvdmVybGF5RGF0YS5yb3RhdGlvbiAqIE1hdGguUEkgLyAxODApOwogICAgICAgICAgICBjdHguc2NhbGUob3ZlcmxheURhdGEuZmxpcFgsIG92ZXJsYXlEYXRhLmZsaXBZKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZSgtY2VudGVyWCwgLWNlbnRlclkpOwoKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShvdmVybGF5LCBvdmVybGF5RGF0YS54ICogc2NhbGUsIG92ZXJsYXlEYXRhLnkgKiBzY2FsZSwgb3ZlcmxheURhdGEud2lkdGggKiBzY2FsZSwgb3ZlcmxheURhdGEuaGVpZ2h0ICogc2NhbGUpOwogICAgICAgICAgICBjdHgucmVzdG9yZSgpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZHJhd0JvdW5kaW5nQm94KG92ZXJsYXlEYXRhKSB7CiAgICAgICAgICAgIGlmIChvdmVybGF5RGF0YS5zZWxlY3RlZCkgewogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gJyNGRjAwMDAnOwogICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDI7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlUmVjdChvdmVybGF5RGF0YS54ICogc2NhbGUsIG92ZXJsYXlEYXRhLnkgKiBzY2FsZSwgb3ZlcmxheURhdGEud2lkdGggKiBzY2FsZSwgb3ZlcmxheURhdGEuaGVpZ2h0ICogc2NhbGUpOwoKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnI0ZGMDAwMCc7CiAgICAgICAgICAgICAgICBkcmF3UmVzaXplSGFuZGxlKG92ZXJsYXlEYXRhLnggKiBzY2FsZSwgb3ZlcmxheURhdGEueSAqIHNjYWxlKTsgCiAgICAgICAgICAgICAgICBkcmF3UmVzaXplSGFuZGxlKG92ZXJsYXlEYXRhLnggKiBzY2FsZSArIG92ZXJsYXlEYXRhLndpZHRoICogc2NhbGUsIG92ZXJsYXlEYXRhLnkgKiBzY2FsZSk7IAogICAgICAgICAgICAgICAgZHJhd1Jlc2l6ZUhhbmRsZShvdmVybGF5RGF0YS54ICogc2NhbGUsIG92ZXJsYXlEYXRhLnkgKiBzY2FsZSArIG92ZXJsYXlEYXRhLmhlaWdodCAqIHNjYWxlKTsgCiAgICAgICAgICAgICAgICBkcmF3UmVzaXplSGFuZGxlKG92ZXJsYXlEYXRhLnggKiBzY2FsZSArIG92ZXJsYXlEYXRhLndpZHRoICogc2NhbGUsIG92ZXJsYXlEYXRhLnkgKiBzY2FsZSArIG92ZXJsYXlEYXRhLmhlaWdodCAqIHNjYWxlKTsgCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRyYXdSZXNpemVIYW5kbGUoeCwgeSkgewogICAgICAgICAgICBjdHguZmlsbFJlY3QoeCAtIHJlc2l6ZUhhbmRsZVNpemUgLyAyLCB5IC0gcmVzaXplSGFuZGxlU2l6ZSAvIDIsIHJlc2l6ZUhhbmRsZVNpemUsIHJlc2l6ZUhhbmRsZVNpemUpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlTW91c2VEb3duKGUpIHsKICAgICAgICAgICAgY29uc3QgbW91c2VYID0gZS5vZmZzZXRYIC8gc2NhbGU7CiAgICAgICAgICAgIGNvbnN0IG1vdXNlWSA9IGUub2Zmc2V0WSAvIHNjYWxlOwoKICAgICAgICAgICAgaWYgKHByZXNldE92ZXJsYXkuc2VsZWN0ZWQgJiYgZ2V0UmVzaXplSGFuZGxlKG1vdXNlWCwgbW91c2VZLCBwcmVzZXRPdmVybGF5KSkgewogICAgICAgICAgICAgICAgaXNSZXNpemluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBjdXJyZW50UmVzaXplSGFuZGxlID0gZ2V0UmVzaXplSGFuZGxlKG1vdXNlWCwgbW91c2VZLCBwcmVzZXRPdmVybGF5KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXN0b21PdmVybGF5LnNlbGVjdGVkICYmIGdldFJlc2l6ZUhhbmRsZShtb3VzZVgsIG1vdXNlWSwgY3VzdG9tT3ZlcmxheSkpIHsKICAgICAgICAgICAgICAgIGlzUmVzaXppbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgY3VycmVudFJlc2l6ZUhhbmRsZSA9IGdldFJlc2l6ZUhhbmRsZShtb3VzZVgsIG1vdXNlWSwgY3VzdG9tT3ZlcmxheSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlc2V0T3ZlcmxheS5zZWxlY3RlZCAmJiBpc1dpdGhpbk92ZXJsYXkobW91c2VYLCBtb3VzZVksIHByZXNldE92ZXJsYXkpKSB7CiAgICAgICAgICAgICAgICBpc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGRyYWdTdGFydFggPSBtb3VzZVggLSBwcmVzZXRPdmVybGF5Lng7CiAgICAgICAgICAgICAgICBkcmFnU3RhcnRZID0gbW91c2VZIC0gcHJlc2V0T3ZlcmxheS55OwogICAgICAgICAgICB9IGVsc2UgaWYgKGN1c3RvbU92ZXJsYXkuc2VsZWN0ZWQgJiYgaXNXaXRoaW5PdmVybGF5KG1vdXNlWCwgbW91c2VZLCBjdXN0b21PdmVybGF5KSkgewogICAgICAgICAgICAgICAgaXNEcmFnZ2luZyA9IHRydWU7CiAgICAgICAgICAgICAgICBkcmFnU3RhcnRYID0gbW91c2VYIC0gY3VzdG9tT3ZlcmxheS54OwogICAgICAgICAgICAgICAgZHJhZ1N0YXJ0WSA9IG1vdXNlWSAtIGN1c3RvbU92ZXJsYXkueTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlTW91c2VNb3ZlKGUpIHsKICAgICAgICAgICAgY29uc3QgbW91c2VYID0gZS5vZmZzZXRYIC8gc2NhbGU7CiAgICAgICAgICAgIGNvbnN0IG1vdXNlWSA9IGUub2Zmc2V0WSAvIHNjYWxlOwoKICAgICAgICAgICAgaWYgKGlzRHJhZ2dpbmcpIHsKICAgICAgICAgICAgICAgIGlmIChwcmVzZXRPdmVybGF5LnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgcHJlc2V0T3ZlcmxheS54ID0gbW91c2VYIC0gZHJhZ1N0YXJ0WDsKICAgICAgICAgICAgICAgICAgICBwcmVzZXRPdmVybGF5LnkgPSBtb3VzZVkgLSBkcmFnU3RhcnRZOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjdXN0b21PdmVybGF5LnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgY3VzdG9tT3ZlcmxheS54ID0gbW91c2VYIC0gZHJhZ1N0YXJ0WDsKICAgICAgICAgICAgICAgICAgICBjdXN0b21PdmVybGF5LnkgPSBtb3VzZVkgLSBkcmFnU3RhcnRZOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZHJhd0ltYWdlcygpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGlzUmVzaXppbmcpIHsKICAgICAgICAgICAgICAgIGlmIChwcmVzZXRPdmVybGF5LnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzaXplT3ZlcmxheShtb3VzZVgsIG1vdXNlWSwgcHJlc2V0T3ZlcmxheSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGN1c3RvbU92ZXJsYXkuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICByZXNpemVPdmVybGF5KG1vdXNlWCwgbW91c2VZLCBjdXN0b21PdmVybGF5KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRyYXdJbWFnZXMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGFuZGxlTW91c2VVcCgpIHsKICAgICAgICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgICBpc1Jlc2l6aW5nID0gZmFsc2U7CiAgICAgICAgICAgIGN1cnJlbnRSZXNpemVIYW5kbGUgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaXNXaXRoaW5PdmVybGF5KG1vdXNlWCwgbW91c2VZLCBvdmVybGF5RGF0YSkgewogICAgICAgICAgICByZXR1cm4gbW91c2VYID4gb3ZlcmxheURhdGEueCAmJiBtb3VzZVggPCBvdmVybGF5RGF0YS54ICsgb3ZlcmxheURhdGEud2lkdGggJiYKICAgICAgICAgICAgICAgICAgIG1vdXNlWSA+IG92ZXJsYXlEYXRhLnkgJiYgbW91c2VZIDwgb3ZlcmxheURhdGEueSArIG92ZXJsYXlEYXRhLmhlaWdodDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldFJlc2l6ZUhhbmRsZShtb3VzZVgsIG1vdXNlWSwgb3ZlcmxheURhdGEpIHsKICAgICAgICAgICAgaWYgKGlzTmVhcihtb3VzZVgsIG1vdXNlWSwgb3ZlcmxheURhdGEueCwgb3ZlcmxheURhdGEueSkpIHJldHVybiAndG9wLWxlZnQnOwogICAgICAgICAgICBpZiAoaXNOZWFyKG1vdXNlWCwgbW91c2VZLCBvdmVybGF5RGF0YS54ICsgb3ZlcmxheURhdGEud2lkdGgsIG92ZXJsYXlEYXRhLnkpKSByZXR1cm4gJ3RvcC1yaWdodCc7CiAgICAgICAgICAgIGlmIChpc05lYXIobW91c2VYLCBtb3VzZVksIG92ZXJsYXlEYXRhLngsIG92ZXJsYXlEYXRhLnkgKyBvdmVybGF5RGF0YS5oZWlnaHQpKSByZXR1cm4gJ2JvdHRvbS1sZWZ0JzsKICAgICAgICAgICAgaWYgKGlzTmVhcihtb3VzZVgsIG1vdXNlWSwgb3ZlcmxheURhdGEueCArIG92ZXJsYXlEYXRhLndpZHRoLCBvdmVybGF5RGF0YS55ICsgb3ZlcmxheURhdGEuaGVpZ2h0KSkgcmV0dXJuICdib3R0b20tcmlnaHQnOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGlzTmVhcih4MSwgeTEsIHgyLCB5MikgewogICAgICAgICAgICByZXR1cm4gTWF0aC5hYnMoeDEgLSB4MikgPCByZXNpemVIYW5kbGVTaXplICYmIE1hdGguYWJzKHkxIC0geTIpIDwgcmVzaXplSGFuZGxlU2l6ZTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHJlc2l6ZU92ZXJsYXkobW91c2VYLCBtb3VzZVksIG92ZXJsYXlEYXRhKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50UmVzaXplSGFuZGxlID09PSAnYm90dG9tLXJpZ2h0JykgewogICAgICAgICAgICAgICAgb3ZlcmxheURhdGEud2lkdGggPSBtb3VzZVggLSBvdmVybGF5RGF0YS54OwogICAgICAgICAgICAgICAgb3ZlcmxheURhdGEuaGVpZ2h0ID0gbW91c2VZIC0gb3ZlcmxheURhdGEueTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50UmVzaXplSGFuZGxlID09PSAndG9wLWxlZnQnKSB7CiAgICAgICAgICAgICAgICBjb25zdCBuZXdXaWR0aCA9IG92ZXJsYXlEYXRhLndpZHRoIC0gKG1vdXNlWCAtIG92ZXJsYXlEYXRhLngpOwogICAgICAgICAgICAgICAgY29uc3QgbmV3SGVpZ2h0ID0gb3ZlcmxheURhdGEuaGVpZ2h0IC0gKG1vdXNlWSAtIG92ZXJsYXlEYXRhLnkpOwogICAgICAgICAgICAgICAgaWYgKG5ld1dpZHRoID4gMCAmJiBuZXdIZWlnaHQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheURhdGEud2lkdGggPSBuZXdXaWR0aDsKICAgICAgICAgICAgICAgICAgICBvdmVybGF5RGF0YS5oZWlnaHQgPSBuZXdIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgb3ZlcmxheURhdGEueCA9IG1vdXNlWDsKICAgICAgICAgICAgICAgICAgICBvdmVybGF5RGF0YS55ID0gbW91c2VZOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByb3RhdGVPdmVybGF5KGFuZ2xlKSB7CiAgICAgICAgICAgIGlmIChwcmVzZXRPdmVybGF5LnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICBwcmVzZXRPdmVybGF5LnJvdGF0aW9uICs9IGFuZ2xlOwogICAgICAgICAgICB9IGVsc2UgaWYgKGN1c3RvbU92ZXJsYXkuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIGN1c3RvbU92ZXJsYXkucm90YXRpb24gKz0gYW5nbGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZHJhd0ltYWdlcygpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZmxpcE92ZXJsYXkoZGlyZWN0aW9uKSB7CiAgICAgICAgICAgIGlmIChwcmVzZXRPdmVybGF5LnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHsKICAgICAgICAgICAgICAgICAgICBwcmVzZXRPdmVybGF5LmZsaXBYICo9IC0xOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHsKICAgICAgICAgICAgICAgICAgICBwcmVzZXRPdmVybGF5LmZsaXBZICo9IC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKGN1c3RvbU92ZXJsYXkuc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJykgewogICAgICAgICAgICAgICAgICAgIGN1c3RvbU92ZXJsYXkuZmxpcFggKj0gLTE7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykgewogICAgICAgICAgICAgICAgICAgIGN1c3RvbU92ZXJsYXkuZmxpcFkgKj0gLTE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZHJhd0ltYWdlcygpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gc2F2ZUltYWdlKCkgewogICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gJ2NhbnZhcy1pbWFnZS5wbmcnOwogICAgICAgICAgICBsaW5rLmhyZWYgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsKICAgICAgICAgICAgbGluay5jbGljaygpOwogICAgICAgIH0KCiAgICAgICAgZmV0Y2hPdmVybGF5R2FsbGVyeSgpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgo=